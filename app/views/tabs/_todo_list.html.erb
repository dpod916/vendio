<div class="wrapper wrapper-content  animated fadeInRight">
<div class="row">
<div class="col-lg-4">
  <div class="ibox">
      <div class="ibox-content">
          <h3>To-do</h3>

          <div class="input-group">
  				  <input type="text" placeholder="Add new task " class="input input-sm form-control">
				    <span class="input-group-btn">
				        <button type="button" class="btn btn-sm btn-white"> <i class="fa fa-plus"></i> Add Task</button>
				    </span>
  				</div>

          <ul class="sortable-list connectList agile-list" id="todo">
            <% item.pending_tasks.each do |task| %>
              <li class="warning-element" id="<%=task.id %>">
                  <h4><%= sanitize(task.name) %></h4>

                  <div class="agile-detail">
                      <a href="#" class="pull-right btn btn-xs btn-white">Tag</a>
                      <i class="fa fa-clock-o"></i><%= task.due_date %>
                  </div>
              </li>
            <% end %>
          </ul>

      </div>
  </div>
</div>

<div class="col-lg-4">
  <div class="ibox">
      <div class="ibox-content">
          <h3>In Progress</h3>
          <ul class="sortable-list connectList agile-list" id="inprogress">
            <% item.started_tasks.each do |task| %>
              <li class="warning-element" id="<%=task.id%>">
                  <h4><%= sanitize(task.name) %></h4>

                  <div class="agile-detail">
                      <a href="#" class="pull-right btn btn-xs btn-white">Tag</a>
                      <i class="fa fa-clock-o"></i><%= task.due_date %>
                  </div>
              </li>
            <% end %>
          </ul>

      </div>
  </div>
</div>

<div class="col-lg-4">
  <div class="ibox">
      <div class="ibox-content">
          <h3>Completed</h3>
          <ul class="sortable-list connectList agile-list" id="completed">
            <% item.completed_tasks.each do |task| %>
              <li class="warning-element" id="<%=task.id%>">
                  <h4><%= sanitize(task.name) %></h4>
                  <div class="agile-detail">
                      <a href="#" class="pull-right btn btn-xs btn-white">Tag</a>
                      <i class="fa fa-clock-o"></i><%= task.due_date %>
                  </div>
              </li>
            <% end %>
          </ul>

      </div>
  </div>
</div>
</div>

<div class="row">
    <div class="col-lg-12">


        <div class="output p-m m white-bg"></div>


    </div>
</div>
<div id="task-form">
<%= simple_form_for(item, html: { class: 'form-horrizontal'}, remote: true)  do |f| %>
    <%= f.hidden_field :task_tokens, as: :string %>
    <%= f.hidden_field :name, as: :string %>
    <%= f.hidden_field :title, as: :string %>
    <%= f.hidden_field :matter, value: item %>
    <%= f.button :submit, id: 'submit-button' %>
<% end %>
</div>

<% content_for :javascript do %>

<script type="text/javascript">


$("#task-form").hide();

    $(function() {

        $("#todo, #inprogress, #completed").sortable({
            connectWith: ".connectList",
            update: function( event, ui ) {

                var todo = $( "#todo" ).sortable( "toArray" );
                var inprogress = $( "#inprogress" ).sortable( "toArray" );
                var completed = $( "#completed" ).sortable( "toArray" );
                $('.output').html("ToDo: " + window.JSON.stringify(todo) + "<br/>" + "In Progress: " + window.JSON.stringify(inprogress) + "<br/>" + "Completed: " + window.JSON.stringify(completed));
            }
        }).disableSelection();


    });


    function post(path, params, method) {
      method = method || "post"; // Set method to post by default if not specified.

      // The rest of this code assumes you are not using a library.
      // It can be made less wordy if you use one.
      var form = document.createElement("form");
      form.setAttribute("method", method);
      form.setAttribute("data-remote", true);
      form.setAttribute("action", path);

      for(var key in params) {
          if(params.hasOwnProperty(key)) {
              var hiddenField = document.createElement("input");
              hiddenField.setAttribute("type", "hidden");
              hiddenField.setAttribute("name", key);
              hiddenField.setAttribute("value", params[key]);

              form.appendChild(hiddenField);
           }
    }

    document.body.appendChild(form);
    form.submit();
}

</script>

<% end %>